apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  # Plugin Barman Cloud for CNPG
  # https://github.com/cloudnative-pg/plugin-barman-cloud
  - https://github.com/cloudnative-pg/plugin-barman-cloud/releases/download/v0.10.0/manifest.yaml

patches:
  - target:
      kind: Deployment
      name: barman-cloud
      namespace: cnpg-system
    patch: |-
      - op: add
        path: /spec/template/spec/containers/0/resources
        value:
          requests:
            cpu: 10m
            memory: 64Mi
          limits:
            cpu: 200m
            memory: 256Mi
